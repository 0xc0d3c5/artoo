# Dependencies
markdown:         redcarpet
highlighter:      pygments

# Permalinks
permalink:        pretty

# Setup
title:            artoo.js
tagline:          'The client-side scraping companion.'
description:      'The client-side scraping companion.'
baseurl:          '/artoo'

author:
  name:           'Yomguithereal'
  url:            https://github.com/Yomguithereal

# Custom vars
version:          0.1.1

sidebar:
  - url: 'quick_start'
    title: 'Quick Start'
  - url: 'hacker_news'
    title: 'Hacker News scraper'
  - 'sep'
  - url: 'methods'
    title: 'Methods'
    children:
      - url: 'expand'
        title: 'Autoexpand'
      - url: 'helpers'
        title: 'Helpers'
      - url: 'instructions'
        title: 'Instructions'
      - url: 'save'
        title: 'Save'
      - url: 'scrape'
        title: 'Scrape'
      - url: 'spiders'
        title: 'Spiders'
      - url: 'store'
        title: 'Store'
  - url: 'settings'
    title: 'Settings'
  - url: 'jquery'
    title: 'jQuery injection'
  - url: 'chrome'
    title: 'Chrome extension'
  - url: 'grunt'
    title: 'Grunt task'
  - 'sep'
  - url: 'changelog'
    title: 'Changelog'

github:
  repo:           https://github.com/medialab/artoo

medialab:
  url:            'http://www.medialab.sciences-po.fr/'

bookmarklets:
  artoo:          'javascript: (function(){var t={},e=!0;if("object"==typeof this.artoo&&(artoo.settings.reload||(artoo.log.verbose("artoo already exists within this page. No need to inject him again."),artoo.loadSettings(t),artoo.hooks.trigger("exec"),e=!1)),e){var o=document.getElementsByTagName("body")[0];o||(o=document.createElement("body"),document.firstChild.appendChild(o));var i=document.createElement("script");console.log("artoo.js is loading..."),i.src="//medialab.github.io/artoo/public/dist/artoo-latest.min.js",i.type="text/javascript",i.id="artoo_injected_script",i.setAttribute("settings",JSON.stringify(t)),o.appendChild(i)}}).call(this);'
  hackernews:     >
    javascript: (function(){var t={eval:&#39;"(function(t){function e(t){return t.find(\\"td.title:last > a\\").attr(\\"href\\")}var r={iterator:\\"tr tr:has(td.title:has(a)):not(:last)\\",data:{title:{sel:\\".title a\\"},url:{sel:\\".title a\\",attr:\\"href\\"},domain:{sel:\\".comhead\\",method:function(t){return t(this).text().trim().replace(/[\\\\(\\\\)]/g,\\"\\")}},score:function(t){return+t(this).find(\\"+ tr [id^=score]\\").text().replace(\\" points\\",\\"\\")},user:{sel:\\"+ tr a[href^=user]\\",method:function(t){return t(this).length?t(this).text():null}},nb_comments:{sel:\\"+ tr a[href^=item]\\",method:function(t){var e=+t(this).text().replace(\\" comments\\",\\"\\");return isNaN(e)?0:e}}}};artoo.log.debug(\\"Starting the scraper...\\");var a=artoo.scrape(r);artoo.ajaxSpider(function(r,a){return e(r?a:t(document))},{limit:2,scrape:r,concat:!0,done:function(t){artoo.log.debug(\\"Finished retrieving data. Downloading...\\"),artoo.savePrettyJson(a.concat(t),{filename:\\"hacker_news.json\\"})}})}).call(this,artoo.$);"&#39;},e=!0;if("object"==typeof this.artoo)artoo.settings.reload||(artoo.log.verbose("artoo already exists within this page. No need to inject him again."),artoo.loadSettings(t),artoo.hooks.trigger("exec"),e=!1);else if(e){var r=document.getElementsByTagName("body")[0],o=document.createElement("script");console.log("artoo is loading..."),o.src="//medialab.github.io/artoo/public/dist/artoo-latest.min.js",o.type="text/javascript",o.id="artoo_injected_script",o.setAttribute("settings",JSON.stringify(t)),r.appendChild(o)}}).call(this);
  gt: >
    javascript: (function(){var t={log:{beeping:!0},eval:&#39;&quot;(function(t){function e(e){var r=this;this.ui=e,this.dom=e.shadow,this.logger=this.dom.querySelector(\\&quot;#log\\&quot;),this.started=!1,this.timeout=null,this.country=null,this.keywords=null,this.resumable=!!artoo.s(\\&quot;gtbatch\\&quot;),this.log=function(e){var o=document.createElement(\\&quot;p\\&quot;);o.innerHTML=e,this.logger.appendChild(o),t(this.logger).scrollTop(t(this.logger)[0].scrollHeight),artoo.log(e)},this.error=function(t){this.log(\&#39;<span class=\\&quot;error\\&quot;>\&#39;+t+\\&quot;</span>\\&quot;)},this.start=function(){this.started=!0,this.log(this.resumable?\\&quot;Resuming...\\&quot;:\\&quot;Starting...\\&quot;),this.initializeBatch(),this.oneGo()},this.initializeBatch=function(){if(this.country=e.$(\\&quot;#countries\\&quot;).val(),this.resumable)this.keywords=artoo.s(\\&quot;gtbatch\\&quot;);else{if(this.keywords={},(o(e.$(\\&quot;#keywords\\&quot;).val())||[]).forEach(function(t){this.keywords[t]=!1},this),!Object.keys(this.keywords).length)return l.log(\\&quot;No keywords specified. Aborting...\\&quot;),void(this.started=!1);artoo.s.set(\\&quot;gtbatch\\&quot;,this.keywords)}},this.oneGo=function(){var t=artoo.helpers.first(Object.keys(this.keywords),function(t){return!r.keywords[t]});if(t)try{i(this.country,t,function(e){var o=r.handleError(e);return o.error?(this.error(\\&quot;Error: \\&quot;+o.reason),void this.log(\\&quot;Fix error and reload page and tool.\\&quot;)):(artoo.saveCsv(e,r.country+\\&quot;_\\&quot;+t+\\&quot;.csv\\&quot;),r.keywords[t]=!0,artoo.s.set(\\&quot;gtbatch\\&quot;,r.keywords),r.log(\\&quot;Fetched \\&quot;+r.country+\\&quot; : \\&quot;+t),artoo.helpers.first(Object.keys(r.keywords),function(t){return!r.keywords[t]})?(r.log(\\&quot;Waiting approximately \\&quot;+s/1e3+\\&quot; seconds before next fetch...\\&quot;),void(r.timeout=setTimeout(function(){r.oneGo()},1e3*Math.floor(10*Math.random()+1)+s))):void r.cleanup())})}catch(e){this.error(\\&quot;Error - try resuming the batch later or solve something on the page.\\&quot;)}else this.cleanup()},this.handleError=function(t){return~t.toLowerCase().indexOf(\\&quot;quota reached\\&quot;)?{error:!0,reason:\\&quot;quota\\&quot;}:~t.indexOf(\\&quot;Please make sure your query is valid\\&quot;)?{error:!0,reason:\\&quot;invalid_query\\&quot;}:~t.indexOf(\\&quot;<title>Redirecting</title>\\&quot;)?{error:!0,reason:\\&quot;dead_end\\&quot;}:~t.indexOf(\\&quot;Error 404\\&quot;)?{error:!0,reason:\\&quot;404_throttle\\&quot;}:{error:!1}},this.cleanup=function(){artoo.s.remove(\\&quot;gtbatch\\&quot;),this.log(\\&quot;Batch finished. Please reload the page and the tool to start a new one.\\&quot;)},this.cancel=function(){this.timeout&&clearTimeout(this.timeout),artoo.s.remove(\\&quot;gtbatch\\&quot;),this.log(\\&quot;Batch canceled. Please reload the page and the tool to start a new one.\\&quot;)},e.$(\\&quot;#start\\&quot;).click(function(){r.started||r.start()}),e.$(\\&quot;#cancel\\&quot;).click(function(){r.cancel()}),this.resumable&&(this.log(\\&quot;You have a running task, you can resume it.\\&quot;),e.$(\\&quot;#start\\&quot;).text(\\&quot;Resume task\\&quot;),e.$(\\&quot;#keywords\\&quot;).text(Object.keys(artoo.s(\\&quot;gtbatch\\&quot;)).join(\\&quot;\\\\n\\&quot;)))}function o(t){return t.trim()?t.split(\\&quot;\\\\n\\&quot;).map(function(t){return t.trim()}).filter(function(t){return t}):!1}function r(t,e){return\\&quot;https://www.google.fr/trends/trendsReport?hl=en-US&q=\\&quot;+encodeURIComponent(e)+\\&quot;&geo=\\&quot;+t+\\&quot;&cmpt=geo&content=0&export=1\\&quot;}function i(e,o,i){t.get(r(e,o),i)}function n(){var t=new artoo.ui;return t.$().html(\\&quot;<style>\\&quot;+styles.join(\\&quot;\\\\n\\&quot;)+\&#39;</style><div id=\\&quot;overlay\\&quot;><h3>Google Trends Batch Downloader</h3><div class=\\&quot;clear\\&quot;><div class=\\&quot;left\\&quot;><textarea id=\\&quot;keywords\\&quot; placeholder=\\&quot;Enter keywords here...\\&quot;></textarea></div><div class=\\&quot;right\\&quot;><select id=\\&quot;countries\\&quot;></select><div id=\\&quot;log\\&quot;></div></div><button id=\\&quot;start\\&quot;>Start</button><button id=\\&quot;cancel\\&quot;>Cancel</button></div></div>\&#39;),a.forEach(function(e){var o=document.createElement(\\&quot;option\\&quot;);o.setAttribute(\\&quot;value\\&quot;,e.id),o.innerHTML=e.label,t.shadow.querySelector(\\&quot;#countries\\&quot;).appendChild(o)}),new e(t)}if(this.ninja)return void artoo.log.verbose(\\&quot;Ninja already injected. Skipping...\\&quot;);artoo.log.info(\\&quot;Parasiting web page...\\&quot;);var s=(document.getElementsByTagName(\\&quot;body\\&quot;)[0],5e4);styles=[\\&quot;#overlay {z-index: 1000000; position: fixed; top: 50px; left: 100px; background-color: white; height: 500px; width: 700px; border-radius: 5px; box-shadow: 1px 1px 5px 3px #656565; padding: 20px;}\\&quot;,\\&quot;#keywords {height: 98%; width: 100%; resize: none;}\\&quot;,\\&quot;#countries {width: 100%;}\\&quot;,\\&quot;#log {height: 90%; border: 1px solid black; width: 100%; margin-top: 16px; overflow-y: scroll}\\&quot;,\\&quot;.clear {clear: both; height: 90%;}\\&quot;,\\&quot;.left {float: left; width: 48%; height: 100%;}\\&quot;,\\&quot;.right {float: right; width: 48%; height: 100%;}\\&quot;,\\&quot;.error {color: red;}\\&quot;];var a=artoo.scrape(\\&quot;#geo-picker-menu > div\\&quot;,{id:\\&quot;data-id\\&quot;,label:\\&quot;data-button-caption\\&quot;}).filter(function(t){return t.id}),l=n();this.ninja=l}).call(this,artoo.$);&quot;&#39;},e=!0;if(&quot;object&quot;==typeof this.artoo&&(artoo.settings.reload||(artoo.log.verbose(&quot;artoo already exists within this page. No need to inject him again.&quot;),artoo.loadSettings(t),artoo.hooks.trigger(&quot;exec&quot;),e=!1)),e){var o=document.getElementsByTagName(&quot;body&quot;)[0];o||(o=document.createElement(&quot;body&quot;),document.firstChild.appendChild(o));var r=document.createElement(&quot;script&quot;);console.log(&quot;artoo.js is loading...&quot;),r.src=&quot;//medialab.github.io/artoo/public/dist/artoo-edge.min.js&quot;,r.type=&quot;text/javascript&quot;,r.id=&quot;artoo_injected_script&quot;,r.setAttribute(&quot;settings&quot;,JSON.stringify(t)),o.appendChild(r)}}).call(this);
